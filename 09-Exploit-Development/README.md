# ‚öîÔ∏è Exploit Development

Comprehensive guide to developing reliable exploits from vulnerability to weaponized payload, covering modern mitigations and bypass techniques.

## üìã Contents

### [Exploit Development Guide](./exploit-development-guide.md)
Complete exploit development lifecycle with real-world case studies:

---

## üéØ Exploit Development Phases

### Phase 1: Bug Identification (Days 1-5)
**Objective**: Discover exploitable vulnerabilities
- Fuzzing campaigns with AFL++, LibFuzzer, Syzkaller
- Static analysis with Ghidra, IDA Pro, CodeQL
- Patch diffing for 1-day research
- Manual code review for logic bugs

**Deliverables**: Crash reproducer, root cause analysis

---

### Phase 2: Vulnerability Analysis (Days 6-10)
**Objective**: Understand exploitability and constraints
- Crash triage and classification
- Memory corruption analysis (ASan, Valgrind)
- Exploit primitive identification
- Mitigation assessment (DEP, ASLR, CFG, CET, etc.)

**Deliverables**: Exploitation strategy document

---

### Phase 3: Weaponization (Days 11-20)
**Objective**: Build working exploit with bypass techniques
- Primitive development (read/write, leak, control-flow)
- ROP/JOP chain construction
- Mitigation bypasses (ASLR leak, DEP bypass, CFG evasion)
- Shellcode development and encoding
- Reliability improvements (heap feng shui, race mitigation)

**Deliverables**: Working proof-of-concept

---

### Phase 4: Testing & Refinement (Days 21-25)
**Objective**: Ensure exploit stability and stealth
- Multi-version testing (patch levels, configurations)
- Anti-debugging and anti-VM techniques
- Payload obfuscation
- CI/CD integration for regression testing

**Deliverables**: Production-ready exploit

---

## üêõ Vulnerability Classes Covered

### Memory Corruption
1. **Stack Overflow**
   - SEH exploitation (32-bit Windows)
   - Egghunting techniques
   - Modern stack protections bypass
   - **Case Study**: CVE-2025-0910 (TinyFTP), CVE-2024-8923 (libwebp)

2. **Heap Overflow**
   - glibc heap exploitation (tcache, fastbin)
   - Windows Segment Heap attacks
   - Safe-linking bypass (glibc 2.32+)
   - **Case Study**: CVE-2025-20301 (ImageMagick)

3. **Use-After-Free (UAF)**
   - Browser UAF exploitation
   - Heap feng shui techniques
   - Fake vtable construction
   - **Case Study**: CVE-2024-4852 (Edge WebView2)

4. **Integer Overflow**
   - Signed/unsigned confusion
   - Multiplication/addition overflows
   - Size calculation vulnerabilities
   - **Real-world examples**: Media parsers, crypto libraries

### Logic & Design Flaws
5. **Race Conditions**
   - TOCTOU (Time-of-Check-Time-of-Use)
   - Double-fetch vulnerabilities
   - Concurrent data structure abuse
   - **Case Study**: Dirty Pipe (Linux kernel)

6. **Type Confusion**
   - C++ RTTI manipulation
   - JavaScript JIT type confusion
   - Union/variant abuse
   - **Case Study**: Browser JIT engines (V8, SpiderMonkey)

7. **Format String Bugs**
   - Stack reading with %x/%p
   - Arbitrary write with %n
   - ASLR bypass via leaks
   - **Modern considerations**: Fortified printf variants

---

## üõ°Ô∏è Mitigation Bypass Techniques

### DEP / NX Bypass
- **ROP (Return-Oriented Programming)**
  - Gadget finding with ROPgadget, Ropper
  - Stack pivoting techniques
  - ret2libc chains

- **JOP (Jump-Oriented Programming)**
  - Dispatch table hijacking
  - Gadget chaining via indirect jumps

- **VirtualProtect Spraying**
  - Memory permission modification
  - Executable region creation

**Case Studies**:
- TinyFTP ROP chain (CVE-2025-0910)
- libwebp JOP chain for CET bypass (CVE-2024-8923)

---

### ASLR Bypass
- **Information Leaks**
  - Uninitialized memory reads
  - Format string vulnerabilities
  - Partial pointer overwrites

- **Heap Spraying**
  - Deterministic layout creation
  - NOP sled techniques

- **Side-Channel Attacks**
  - Cache timing (Spectre-like)
  - Branch prediction analysis

**Case Studies**:
- WebView2 ASLR bypass via object leak (CVE-2024-4852)
- ImageMagick info leak (CVE-2025-20301)

---

### CFG / CFI Bypass
- **Indirect Call Targets**
  - Valid call targets identification
  - Function pointer overwrites to allowed targets

- **Data-Only Attacks**
  - Critical variable manipulation
  - Logic flow corruption without hijacking

**Modern Mitigations**: XFG prototype matching

---

### CET Shadow Stack Bypass
- **JOP Instead of ROP**
  - Gadget chains using jumps (no returns)
  - Dispatch table corruption

- **State Corruption**
  - Shadow stack pointer manipulation
  - VTL transition abuse (Windows)

**Case Studies**:
- libwebp CET bypass with JOP (CVE-2024-8923)
- WebView2 NtContinue exploitation

---

### XFG (eXtended Flow Guard) Bypass
- **Prototype Matching**
  - Finding functions with identical signatures
  - Hash collision search

- **Unprotected Modules**
  - Legacy DLL targeting
  - JIT-compiled code abuse

**Case Studies**: Edge WebView2 XFG bypass (CVE-2024-4852)

---

### MTE (Memory Tagging Extension) Bypass
- **Tag Collision**
  - Probabilistic success (4-bit tags = 1/16 chance)
  - Heap spraying for reliability

- **Untagged Regions**
  - Stack/JIT/kernel allocations
  - Mixed tagged/untagged exploitation

**Platform**: Android 14+, Linux ARM64

---

## üîß Exploit Development Tools

### Debugging & Analysis
- **GDB + GEF/PEDA/pwndbg**: Linux debugging with exploit helpers
- **WinDbg + mona.py**: Windows exploit development
- **IDA Pro / Ghidra**: Static analysis and ROP gadget hunting
- **x64dbg**: Modern Windows debugger
- **frida**: Dynamic instrumentation for mobile/desktop

### Exploit Frameworks
- **pwntools**: Python exploit development library
- **Metasploit**: Exploit framework and payload generation
- **ROPgadget / Ropper**: Automated gadget finding
- **one_gadget**: Magic gadget finder for libc
- **ret-sync**: Debugger synchronization with disassemblers

### Shellcode Development
- **msfvenom**: Metasploit payload generator
- **Donut**: In-memory .NET assembly loader
- **sRDI**: Shellcode reflective DLL injection
- **ShellcodeCompiler**: C to shellcode conversion
- **AVET**: Antivirus evasion tool

### Testing & Automation
- **pwntools tmux**: Multi-process debugging
- **Dockerfile**: Reproducible exploit environments
- **GitHub Actions**: CI/CD for exploit reliability
- **QEMU**: Cross-architecture testing

---

## üìö Detailed Coverage

### Stack Overflow Deep Dive
**Concepts**:
- Buffer overflow mechanics
- Return address overwrite
- Saved frame pointer manipulation

**Techniques**:
1. **Classic Stack Smashing** (ASLR/DEP disabled)
2. **SEH Overwrite** (32-bit Windows)
   - Exception handler hijacking
   - SafeSEH bypass
   - SEHOP bypass (GuardEHCont)
3. **Egghunting** (Limited buffer space)
   - 32-bit and 64-bit egghunters
   - SEH-based egghunter
   - NtContinue-based (Windows 11)

**Case Studies**:
- **CVE-2025-0910 (TinyFTP)**: Complete exploitation walkthrough
  - Bad character identification
  - SEH exploitation
  - DEP bypass with ROP
  - Shellcode execution

- **CVE-2024-8923 (libwebp)**: Modern stack overflow
  - Integer overflow to stack overflow
  - CET Shadow Stack bypass with JOP
  - XFG bypass via prototype matching
  - Sandbox escape

---

### Use-After-Free (UAF) Deep Dive
**Concepts**:
- Heap allocation/deallocation
- Dangling pointer dereference
- Type confusion via reallocation

**Techniques**:
1. **Heap Feng Shui**
   - Deterministic heap layout
   - Object spray-and-reclaim
2. **Fake Object Construction**
   - Vtable forging
   - Method pointer redirection
3. **Information Leak**
   - Pointer disclosure
   - Heap address extraction

**Case Studies**:
- **CVE-2024-4852 (Edge WebView2)**:
  - JavaScript trigger development
  - Heap feng shui for reliable reclaim
  - Fake vtable construction
  - CET bypass via JOP chains
  - XFG bypass with prototype matching
  - Sandbox escape techniques

---

### Heap Overflow Deep Dive
**Concepts**:
- Heap metadata corruption
- Adjacent chunk overwrite
- Allocator-specific attacks

**glibc Heap Exploitation**:
1. **Tcache Poisoning**
   - Overwrite `tcache_entry->next`
   - Arbitrary allocation primitive
   - Safe-linking bypass (2.32+)

2. **Fastbin Attack**
   - Double-free exploitation
   - fd pointer corruption

**Windows Heap Exploitation**:
1. **Segment Heap Attacks**
   - Metadata manipulation
   - LFH (Low Fragmentation Heap) exploitation

**Case Studies**:
- **CVE-2025-20301 (ImageMagick)**:
  - Heap overflow in PNG parser
  - glibc tcache poisoning
  - Safe-linking bypass
  - Arbitrary file write primitive

---

## üéì Learning Path

### Beginner Track (0-3 months)
**Prerequisites**: C programming, basic assembly
1. **Week 1-2**: Stack overflows (Linux, no protections)
2. **Week 3-4**: Shellcode basics
3. **Week 5-6**: Introduction to ROP
4. **Week 7-8**: Basic heap overflows
5. **Week 9-12**: ASLR bypass techniques

**Practice**:
- [pwnable.kr](https://pwnable.kr/) - Easy/Toddler challenges
- [exploit.education](https://exploit.education/) - Phoenix stack levels

---

### Intermediate Track (3-9 months)
**Prerequisites**: Comfortable with GDB, basic ROP
1. **Month 4**: Advanced ROP (ret2libc, ret2csu)
2. **Month 5**: Heap exploitation (fastbin, tcache)
3. **Month 6**: Format string vulnerabilities
4. **Month 7**: Windows exploitation (SEH, egghunting)
5. **Month 8**: UAF exploitation
6. **Month 9**: Integer overflows

**Practice**:
- [pwnable.tw](https://pwnable.tw/) - Medium challenges
- [ROP Emporium](https://ropemporium.com/) - Complete chain
- [how2heap](https://github.com/shellphish/how2heap) - All techniques

---

### Advanced Track (9-18 months)
**Prerequisites**: Multiple CTF wins, exploit CVEs
1. **Month 10-11**: Kernel exploitation basics
2. **Month 12-13**: Browser exploitation (V8, JIT)
3. **Month 14-15**: Modern mitigation bypasses (CET, XFG, MTE)
4. **Month 16-17**: Mobile exploitation (iOS PAC, Android)
5. **Month 18**: Hypervisor/VM escape

**Practice**:
- Real-world CVEs exploitation
- 0-day research projects
- Bug bounty programs

---

### Expert Track (18+ months)
**Prerequisites**: Published CVEs, conference talks
1. **Advanced Topics**:
   - Trusted Execution Environment (TEE) attacks
   - Confidential computing exploitation
   - Custom mitigation bypass development
   - Exploit automation frameworks

2. **Research Areas**:
   - Novel attack surface discovery
   - Mitigation effectiveness analysis
   - Tooling development

**Achievements**:
- Pwn2Own participation
- CVE publications
- Security conference presentations (BlackHat, DEF CON)

---

## üìä Exploit Reliability Matrix

| Bug Class | Typical Reliability | Improvement Techniques |
|-----------|---------------------|------------------------|
| Stack Overflow | üü¢ High (95%+) | Static offsets, version detection |
| Heap Overflow | üü° Medium (60-80%) | Heap feng shui, grooming |
| UAF | üü° Medium (50-70%) | Object spraying, timing |
| Race Condition | üî¥ Low (10-30%) | CPU pinning, busy loops |
| Integer Overflow | üü¢ High (90%+) | Deterministic math |
| Type Confusion | üü° Medium (60-80%) | Type spray, validation bypass |

**Legend**: üü¢ High | üü° Medium | üî¥ Low

---

## üèÜ Real-World Exploit Showcase

### Case Study Summary
All case studies include:
- ‚úÖ Complete source code (where available)
- ‚úÖ Step-by-step exploitation walkthrough
- ‚úÖ Mitigation analysis and bypass
- ‚úÖ Debugging tips and troubleshooting
- ‚úÖ Proof-of-concept exploit code
- ‚úÖ Lessons learned and patch analysis

### Included Case Studies
1. **CVE-2025-0910** (TinyFTP) - Classic stack overflow with modern twists
2. **CVE-2024-8923** (libwebp) - Integer ‚Üí stack overflow, CET/XFG bypass
3. **CVE-2024-4852** (Edge WebView2) - UAF with sandbox escape
4. **CVE-2025-20301** (ImageMagick) - Heap overflow, tcache poisoning
5. **Dirty Pipe** (Linux kernel) - Race condition to privilege escalation

---

## üìö Essential Resources

### Books
- "Hacking: The Art of Exploitation" (2nd Ed.) - Jon Erickson
- "The Shellcoder's Handbook" - Anley et al.
- "A Guide to Kernel Exploitation" - Enrico Perla
- "The Browser Hacker's Handbook" - Alcorn et al.

### Online Courses
- [pwn.college](https://pwn.college/) - ASU's comprehensive pwn course
- [Nightmare](https://guyinatuxedo.github.io/) - Modern binary exploitation
- [ROP Emporium](https://ropemporium.com/) - ROP chain practice
- [Azeria Labs](https://azeria-labs.com/) - ARM exploitation

### Practice Platforms
- **CTF**: pwnable.kr, pwnable.tw, HackTheBox
- **Wargames**: OverTheWire, Microcorruption
- **Bug Bounty**: HackerOne, Bugcrowd, Synack

---

## ‚ö†Ô∏è Ethical Guidelines

### Responsible Exploit Development
‚úÖ **Always**:
- Obtain written authorization before testing
- Follow responsible disclosure (90-day standard)
- Report vulnerabilities to vendors
- Use exploits only in legal contexts (pentests, CTFs, research)

‚ùå **Never**:
- Exploit production systems without permission
- Sell exploits to malicious actors
- Publish 0-day exploits without vendor coordination
- Weaponize for criminal purposes

### Legal Frameworks
- **CFAA** (US): Computer Fraud and Abuse Act
- **CMA** (UK): Computer Misuse Act
- **EU Directive 2013/40/EU**: Attacks against information systems

---

## üîÑ Update Log

- **2025-01**: Added comprehensive case studies (TinyFTP, libwebp, WebView2)
- **2025-01**: Modern mitigation bypass techniques (CET, XFG, MTE)
- **2025-01**: Heap exploitation with safe-linking bypass
- **2024-12**: Initial exploit development guide created

---

**Difficulty Ratings**:
- üü¢ **Beginner**: Basic stack overflows
- üü° **Intermediate**: ROP chains, heap exploitation
- üî¥ **Advanced**: Modern bypasses, browser/kernel pwn
- ‚ö´ **Expert**: 0-day research, full-chain development
